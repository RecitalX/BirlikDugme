@model Kurumsal.Models.Blog
@{
    ViewBag.Title = "BlogDetay";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="ftco-blocks-cover-1">
    <div class="site-section-cover overlay" data-stellar-background-ratio="0.5" style="background-image: url(@Model.ResimURL);background-position: center;background-size: cover;">
        <div class="container">
            <div class="row align-items-center justify-content-center text-center">
                <div class="col-md-7">
                    <h1 class="mb-4" data-aos="fade-up" data-aos-delay="100">@Model.Baslik</h1>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="site-section">
    <div class="container">

        <div class="row">
            <div class="col-md-8 blog-content">
                <h2 style="font-weight:bold;">@Model.Baslik</h2>

                <div class="pt-2">
                    <h4>
                        <span class="badge badge-orange">@Model.Kategori.KategoriAd</span>
                        <span class="badge badge-orange">
                            <i class="fas fa-comment"></i>&nbsp;

                            @if (Model.Yorum.Where(x => x.Onay == true).Count() == 0)
                            {
                                <span href="#">0</span>
                            }
                            else
                            {
                                <span href="#">
                                    @ViewBag.YorumSayisi
                                </span>
                            }
                        </span>
                    </h4>
                </div>

                <blockquote class="mt-4" style="font-weight:bold">
                    @Model.Aciklama
                </blockquote>

                <div style="padding-left:10px; padding-right:10px;" class="mb-5">
                    <p>@Html.Raw(Model.Icerik)</p>
                </div>

                <hr />

                <div class="comment-form-wrap pt-5">
                    <h3 class="mb-5 font-weight-bold">Bir yorum yap!</h3>
                    <form action="#" class="">
                        <div class="form-group">
                            <label for="name">İsim *</label>
                            <input type="text" name="adsoyad" id="adsoyad" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="email">Email *</label>
                            <input type="email" name="eposta" class="form-control" id="eposta">
                        </div>

                        <div class="form-group">
                            <label for="message">Mesaj</label>
                            <textarea id="icerik" name="icerik" cols="30" rows="10" maxlength="150" class="form-control"></textarea>
                        </div>
                        <div class="form-group">
                            <input type="submit" id="gonder" value="Yorum Yap" class="btn btn-orange btn-md text-white">
                        </div>

                    </form>

                </div>

                <div class="mt-5">

                    @if (Model.Yorum.Where(x => x.Onay == true).Count() == 0)
                    {

                    }
                    else
                    {
                        <h3 class="mb-5 font-weight-bold">Yorumlar (@ViewBag.YorumSayisi)</h3>
                    }

                    <ul class="comment-list">

                        @foreach (var item in Model.Yorum.OrderByDescending(x => x.YorumId).Where(x => x.Onay == true))
                        {

                            <li class="comment" style="border-top: 1px solid rgba(0,0,0,.1); padding-top:25px;">

                                <div class="vcard bio text-center" style="font-size:30px;">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div class="comment-body">
                                    <span class="font-weight-bold" style="font-size:25px;">
                                        @item.AdSoyad
                                    </span>
                                    <p>
                                        @item.Eposta
                                    </p>
                                    <p>
                                        @item.Icerik
                                    </p>
                                </div>
                            </li>

                        }

                    </ul>
                    <!-- END comment-list -->

                </div>

            </div>
            <div class="col-md-4 sidebar">

                <div class="sidebar-box bg-light">
                    @{
                        Html.RenderAction("BlogKategoriPartial", "Home");
                    }
                </div>

                <div class="sidebar-box bg-light">

                    <h4 class="footer-heading mb-4 font-weight-bold">Arama yap!</h4>

                    <form action="/Home/AramaYap" method="post" class="d-flex">
                        <input type="text" class="form-control mr-3" name="aranan" placeholder="Ara">
                        <input type="submit" value="Ara" class="btn btn-orange rounded-0">
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="~/Scripts/jquery-3.3.1.js"></script>
<script type="text/javascript">
    $(document).ready(function () {

        $("#gonder").click(function () {
            var adisoyadi = $("#adsoyad").val();
            var epostasi = $("#eposta").val();
            var yorumunuz = $("#icerik").val();
            $.ajax({
                url: '/Home/YorumYap/',
                data: {adsoyad:adisoyadi,eposta: epostasi,icerik:yorumunuz,blogid:@Model.BlogId },
                type: 'POST',
                dataType: 'json',
                success: function (data) {
                    alert("Yorumunuz eklendi, kontrol edildikten sonra yayınlanacaktır.");
                }
            });
        });
    })

</script>

